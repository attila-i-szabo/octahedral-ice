## Monte Carlo simulations of octahedral spin ice

This repository provides a "library" for Monte Carlo simulations of dipolar and near-neighbour spin ice on the antiperovskite lattice, as well as computing thermal averages of quantities like magnetisation, emergent monopole density, and structure factors. It also includes several program files and (post)processing scripts that allow reconstructing our results in the paper [Fragmented spin ice and multi-*k* ordering in rare-earth antiperovskites](https://arxiv.org/abs/2203.08834).

### Usage

Every program file in the directory `c++` can be compiled and linked using the command
```
make XXX.out
```
where `XXX.cc` is the name of the program file. The purpose and calling sequence of each program is given in the header of the source file. None of the programs is parallelised.

After linking all program files, the raw simulation data presented in the paper can be reproduced by running `./generate.sh`, which also gives examples for the calling sequence of each program. The scripts in `bash` break down each task into smaller pieces that can be submitted to a SLURM server independently.

The thermodynamic data presented in Figures 2 and 3a can be generated from the raw energy data by running `./thermo.sh`, which uses the scripts `heatcap*.py` and `entropy_grid.py`.

Neutron-scattering patterns and magnetic order parameters can be generated using the Python scripts `symmetrise.py`, `neutron.py`, `powder.py`, `OP.py`, and `OP_grid.py`. `./magnetic.sh` generates most such data showed in the paper.

Autocorrelation functions of the raw samples generated by `all_samples.out` can be computed using `autocorr.py`.

The purpose and calling sequence of every Python script is given in the header comments.

### Licence

All code in this repository is free to use and/or modify under the GNU GPL v2, see `LICENSE`. If you use the code for your academic projects, please cite the paper [Fragmented spin ice and multi-*k* ordering in rare-earth antiperovskites](https://arxiv.org/abs/2203.08834).

The code depends on the [FFTW](https://www.fftw.org/) and [GSL](https://www.gnu.org/software/gsl/) libraries, also licenced under the GPL.